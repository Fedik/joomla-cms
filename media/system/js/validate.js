var JFormValidator=function(){"use strict";var handlers,inputEmail,custom,setHandler=function(name,fn,en){en=en===""?true:en;handlers[name]={enabled:en,exec:fn}},findLabel=function(id,form){var $label,$form=jQuery(form);if(!id){return false}$label=$form.find("#"+id+"-lbl");if($label.length){return $label}$label=$form.find('label[for="'+id+'"]');if($label.length){return $label}return false},handleResponse=function(state,$el){var $label=$el.data("label");if($label===undefined){$label=findLabel($el.attr("id"),$el.get(0).form);$el.data("label",$label)}if(state===false){$el.addClass("invalid").attr("aria-invalid","true");if($label){$label.addClass("invalid")}}else{$el.removeClass("invalid").attr("aria-invalid","false");if($label){$label.removeClass("invalid")}}},validate=function(el){var $el=jQuery(el),tagName,handler;if($el.attr("disabled")){handleResponse(true,$el);return true}if($el.attr("required")||$el.hasClass("required")){tagName=$el.prop("tagName").toLowerCase();if(tagName==="fieldset"&&($el.hasClass("radio")||$el.hasClass("checkboxes"))){if(!$el.find("input:checked").length){handleResponse(false,$el);return false}}else if(!$el.val()||$el.hasClass("placeholder")||$el.attr("type")==="checkbox"&&!$el.is(":checked")){handleResponse(false,$el);return false}}handler=$el.attr("class")&&$el.attr("class").match(/validate-([a-zA-Z0-9\_\-]+)/)?$el.attr("class").match(/validate-([a-zA-Z0-9\_\-]+)/)[1]:"";if($el.attr("pattern")&&$el.attr("pattern")!=""){if($el.val().length){isValid=new RegExp("^"+$el.attr("pattern")+"$").test($el.val());handleResponse(isValid,$el);return isValid}else{handleResponse(false,$el);return false}}else{if(handler===""){handleResponse(true,$el);return true}if(handler&&handler!=="none"&&handlers[handler]&&$el.val()){if(handlers[handler].exec($el.val(),$el)!==true){handleResponse(false,$el);return false}}handleResponse(true,$el);return true}},isValid=function(form){var fields,valid=true,message,error,label,invalid=[],i,l;fields=jQuery(form).find("input, textarea, select, fieldset");for(i=0,l=fields.length;i<l;i++){if(jQuery(fields[i]).hasClass("novalidate")){continue}if(validate(fields[i])===false){valid=false;invalid.push(fields[i])}}jQuery.each(custom,function(key,validator){if(validator.exec()!==true){valid=false}});if(!valid&&invalid.length>0){message=Joomla.JText._("JLIB_FORM_FIELD_INVALID");error={error:[]};for(i=invalid.length-1;i>=0;i--){label=jQuery(invalid[i]).data("label");if(label){error.error.push(message+label.text().replace("*",""))}}Joomla.renderMessages(error)}return valid},attachToForm=function(form){var inputFields=[],elements,$form=jQuery(form);elements=$form.find("input, textarea, select, fieldset, button");for(var i=0,l=elements.length;i<l;i++){var $el=jQuery(elements[i]),tagName=$el.prop("tagName").toLowerCase();if((tagName==="input"||tagName==="button")&&($el.attr("type")==="submit"||$el.attr("type")==="image")){if($el.hasClass("validate")){$el.on("click",function(){return isValid(form)})}}else if(tagName!=="button"&&!(tagName==="input"&&$el.attr("type")==="button")){if($el.hasClass("required")){$el.attr("aria-required","true").attr("required","required")}if(tagName!=="fieldset"){$el.on("blur",function(){return validate(this)});if($el.hasClass("validate-email")&&inputEmail){elements[i].setAttribute("type","email")}}inputFields.push($el)}}$form.data("inputfields",inputFields)},initialize=function(){handlers={};custom=custom||{};inputEmail=function(){var input=document.createElement("input");input.setAttribute("type","email");return input.type!=="text"}();setHandler("username",function(value,element){var regex=new RegExp("[<|>|\"|'|%|;|(|)|&]","i");return!regex.test(value)});setHandler("password",function(value,element){var regex=/^\S[\S ]{2,98}\S$/;return regex.test(value)});setHandler("numeric",function(value,element){var regex=/^(\d|-)?(\d|,)*\.?\d*$/;return regex.test(value)});setHandler("email",function(value,element){value=punycode.toASCII(value);var regex=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return regex.test(value)});var forms=jQuery("form.form-validate");for(var i=0,l=forms.length;i<l;i++){attachToForm(forms[i])}};initialize();return{isValid:isValid,validate:validate,setHandler:setHandler,attachToForm:attachToForm,custom:custom}};document.formvalidator=null;jQuery(function(){document.formvalidator=new JFormValidator;jQuery(document).on("submit","form.form-validate",function(){if(!this.noValidate&&!document.formvalidator.isValid(this)){return false}})});