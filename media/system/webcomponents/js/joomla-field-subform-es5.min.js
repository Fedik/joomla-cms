!function t(e,r,i){function n(o,u){if(!r[o]){if(!e[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var b=r[o]={exports:{}};e[o][0].call(b.exports,function(t){var r=e[o][1][t];return n(r||t)},b,b.exports,t,e,r,i)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var r,i=0;i<e.length;i++)(r=e[i]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();!function(t){function e(t,e){for(var r;t;){if((r=t.parentElement)&&r[u](e))return r;t=r}return null}var r=32,a=27,o=13,u="matches";["matches","msMatchesSelector"].some(function(t){return!("function"!=typeof document.body[t]||(u=t,0))});var s=function(t){function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=(void 0===e?"undefined":i(e))&&"function"!=typeof e?t:e}(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":i(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,HTMLElement),n(s,[{key:"connectedCallback",value:function(){var t=this;if(this.containerWithRows=this,this.rowsContainer)for(var i=this.querySelectorAll(this.rowsContainer),n=0,a=i.length;n<a;n++)if(e(i[n],"joomla-field-subform")===this){this.containerWithRows=i[n];break}this.lastRowNum=this.getRows().length,this.template="",this.prepareTemplate(),(this.buttonAdd||this.buttonRemove)&&(this.addEventListener("click",function(r){var i=t.buttonAdd?e(r.target,t.buttonAdd):null,n=t.buttonRemove?e(r.target,t.buttonRemove):null;if(i&&e(i,"joomla-field-subform")===t){var a=e(i,t.repeatableElement);t.addRow(a)}else if(n&&e(n,"joomla-field-subform")===t){var o=e(n,t.repeatableElement);t.removeRow(o)}}),this.addEventListener("keydown",function(i){if(i.keyCode===r){var n=t.buttonAdd&&i.target[u](t.buttonAdd),a=t.buttonRemove&&i.target[u](t.buttonRemove);if((n||a)&&e(i.target,"joomla-field-subform")===t){var o=e(i.target,t.repeatableElement);n?t.addRow(o):t.removeRow(o),i.preventDefault()}}})),this.buttonMove&&this.setUpDragSort()}},{key:"getRows",value:function(){for(var t=this.containerWithRows.children,e=document.body.msMatchesSelector?"msMatchesSelector":"matches",r=[],i=0,n=t.length;i<n;i++)t[i][e](this.repeatableElement)&&r.push(t[i]);return result}},{key:"prepareTemplate",value:function(){var t=[].slice.call(this.children).filter(function(t){return t.classList.contains("subform-repeatable-template-section")});if(t[0]&&(this.template=t[0].innerHTML),!this.template)throw new Error("The row template are required to subform element to work")}},{key:"addRow",value:function(t){var e=this.getRows().length;if(e>=this.maximum)return null;var r;(r="TBODY"===this.containerWithRows.nodeName||"TABLE"===this.containerWithRows.nodeName?document.createElement("tbody"):document.createElement("div")).innerHTML=this.template;var i=r.children[0];return t?t.parentNode.insertBefore(i,t.nextSibling):this.containerWithRows.append(i),this.buttonMove&&(i.setAttribute("draggable","false"),i.setAttribute("aria-grabbed","false"),i.setAttribute("tabindex","0")),i.setAttribute("data-new","1"),this.fixUniqueAttributes(i,e),this.dispatchEvent(new CustomEvent("subform-row-add",{detail:{row:i},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(i,"joomla:updated"),i}},{key:"removeRow",value:function(t){this.getRows().length<=this.minimum||(this.dispatchEvent(new CustomEvent("subform-row-remove",{detail:{row:t},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(t,"joomla:removed"),t.parentNode.removeChild(t))}},{key:"fixUniqueAttributes",value:function(t,r){this.lastRowNum++,r=r||0;var i=t.getAttribute("data-group"),n=t.getAttribute("data-base-name"),a=Math.max(this.lastRowNum,r+1),o=n+a;this.lastRowNum=a,t.setAttribute("data-group",o);for(var u=t.querySelectorAll("[name]"),s={},l=0,b=u.length;l<b;l++){var f=u[l],m=f.getAttribute("name"),d=m.replace(/(\[\]$)/g,"").replace(/(\]\[)/g,"__").replace(/\[/g,"_").replace(/\]/g,""),c=m.replace("["+i+"][","["+o+"]["),h=d.replace(i,o),g=0,p=d;if("checkbox"===f.type&&m.match(/\[\]$/)){if(!(g=s[d]?s[d].length:0)){var v=e(f,"fieldset.checkboxes"),y=t.querySelector('label[for="'+d+'"]');v&&v.setAttribute("id",h),y&&(y.setAttribute("for",h),y.setAttribute("id",h+"-lbl"))}p+=g,h+=g}else if("radio"===f.type){if(!(g=s[d]?s[d].length:0)){var w=e(f,"fieldset.radio"),A=t.querySelector('label[for="'+d+'"]');w&&w.setAttribute("id",h),A&&(A.setAttribute("for",h),A.setAttribute("id",h+"-lbl"))}p+=g,h+=g}s[d]?s[d].push(!0):s[d]=[!0],f.setAttribute("name",c),f.setAttribute("id",h);var E=t.querySelector('label[for="'+p+'"]');E&&(E.setAttribute("for",h),E.setAttribute("id",h+"-lbl"))}}},{key:"setUpDragSort",value:function(){for(var t,i=this.getRows(),n=0,s=i.length;n<s;n++)(t=i[n]).setAttribute("draggable","false"),t.setAttribute("aria-grabbed","false"),t.setAttribute("tabindex","0");this.addEventListener("mousedown",function(t){var r,i=(r=t.target,!r.form&&r[u](that.buttonMove)?r:e(r,that.buttonMove)),n=i?e(i,that.repeatableElement):null;n&&e(n,"joomla-field-subform")===that&&(n.setAttribute("draggable","true"),n.setAttribute("aria-grabbed","true"),item=n)}),this.addEventListener("mouseup",function(){item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)}),this.addEventListener("keydown",function(t){if((t.keyCode===a||t.keyCode===r||t.keyCode===o)&&!t.target.form&&t.target[u](that.repeatableElement)){var i=t.target;if(i&&e(i,"joomla-field-subform")===that&&(t.keyCode===r&&(l=t,l.ctrlKey||l.metaKey||l.shiftKey)&&("true"===i.getAttribute("aria-grabbed")?(i.setAttribute("draggable","false"),i.setAttribute("aria-grabbed","false"),item=null):(item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),i.setAttribute("draggable","true"),i.setAttribute("aria-grabbed","true"),item=i),t.preventDefault()),t.keyCode===a&&item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),t.keyCode===o&&item)){if(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),i===item)return void(item=null);var n=!1;if(item.parentNode===i.parentNode)for(var s=item;s;s=s.previousSibling)if(s===i){n=!0;break}n?i.parentNode.insertBefore(item,i):i.parentNode.insertBefore(item,i.nextSibling),t.preventDefault(),item=null}}var l}),this.addEventListener("dragstart",function(t){item&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",""))}),this.addEventListener("dragover",function(t){item&&t.preventDefault()}),this.addEventListener("dragenter",function(t){if(item&&(!that.rowsContainer||e(t.target,that.rowsContainer)===that.containerWithRows)){var r=t.target[u](that.repeatableElement)?t.target:e(t.target,that.repeatableElement);if(r){var i=!1;if(item.parentNode===r.parentNode)for(var n=item;n;n=n.previousSibling)if(n===r){i=!0;break}i?r.parentNode.insertBefore(item,r):r.parentNode.insertBefore(item,r.nextSibling)}}}),this.addEventListener("dragend",function(){item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)})}},{key:"buttonAdd",get:function(){return this.getAttribute("button-add")}},{key:"buttonRemove",get:function(){return this.getAttribute("button-remove")}},{key:"buttonMove",get:function(){return this.getAttribute("button-move")}},{key:"rowsContainer",get:function(){return this.getAttribute("rows-container")}},{key:"repeatableElement",get:function(){return this.getAttribute("repeatable-element")}},{key:"minimum",get:function(){return this.getAttribute("minimum")}},{key:"maximum",get:function(){return this.getAttribute("maximum")}}]),s}();t.define("joomla-field-subform",s)}(customElements)},{}]},{},[1]);