!function t(e,r,a){function n(o,u){if(!r[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var b=r[o]={exports:{}};e[o][0].call(b.exports,function(t){var r=e[o][1][t];return n(r||t)},b,b.exports,t,e,r,a)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(t,e,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var r,a=0;a<e.length;a++)(r=e[a]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}();!function(t){function e(t,e){for(var r;t;){if((r=t.parentElement)&&r[i](e))return r;t=r}return null}var r={SPACE:32,ESC:27,ENTER:13},i="matches";["matches","msMatchesSelector"].some(function(t){return!("function"!=typeof document.body[t]||(i=t,0))});var o=function(t){function o(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this)),n=t;if(t.containerWithRows=t,t.rowsContainer)for(var u=t.querySelectorAll(t.rowsContainer),l=0,s=u.length;l<s;l++)if(e(u[l],"joomla-field-subform")===t){t.containerWithRows=u[l];break}return t.lastRowNum=t.getRows().length,t.template="",t.prepareTemplate(),(t.buttonAdd||t.buttonRemove)&&(t.addEventListener("click",function(t){var r=null,a=null;if(n.buttonAdd&&(r=t.target[i](n.buttonAdd)?t.target:e(t.target,n.buttonAdd)),n.buttonRemove&&(a=t.target[i](n.buttonRemove)?t.target:e(t.target,n.buttonRemove)),r&&e(r,"joomla-field-subform")===n){var o=e(r,n.repeatableElement);o=e(o,"joomla-field-subform")===n?o:null,n.addRow(o),t.preventDefault()}else if(a&&e(a,"joomla-field-subform")===n){var u=e(a,n.repeatableElement);n.removeRow(u),t.preventDefault()}}),t.addEventListener("keydown",function(t){if(t.keyCode===r.SPACE){var a=n.buttonAdd&&t.target[i](n.buttonAdd),o=n.buttonRemove&&t.target[i](n.buttonRemove);if((a||o)&&e(t.target,"joomla-field-subform")===n){var u=e(t.target,n.repeatableElement);u=e(u,"joomla-field-subform")===n?u:null,o&&u?n.removeRow(u):a&&n.addRow(u),t.preventDefault()}}})),t.buttonMove&&t.setUpDragSort(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,HTMLElement),n(o,[{key:"buttonAdd",get:function(){return this.getAttribute("button-add")}},{key:"buttonRemove",get:function(){return this.getAttribute("button-remove")}},{key:"buttonMove",get:function(){return this.getAttribute("button-move")}},{key:"rowsContainer",get:function(){return this.getAttribute("rows-container")}},{key:"repeatableElement",get:function(){return this.getAttribute("repeatable-element")}},{key:"minimum",get:function(){return this.getAttribute("minimum")}},{key:"maximum",get:function(){return this.getAttribute("maximum")}}]),n(o,[{key:"getRows",value:function(){for(var t=this.containerWithRows.children,e=document.body.msMatchesSelector?"msMatchesSelector":"matches",r=[],a=0,n=t.length;a<n;a++)t[a][e](this.repeatableElement)&&r.push(t[a]);return result}},{key:"prepareTemplate",value:function(){var t=[].slice.call(this.children).filter(function(t){return t.classList.contains("subform-repeatable-template-section")});if(t[0]&&(this.template=t[0].innerHTML),!this.template)throw new Error("The row template are required to subform element to work")}},{key:"addRow",value:function(t){var e,r=this.getRows().length;if(r>=this.maximum)return null;(e="TBODY"===this.containerWithRows.nodeName||"TABLE"===this.containerWithRows.nodeName?document.createElement("tbody"):document.createElement("div")).innerHTML=this.template;var a=e.children[0];return t?t.parentNode.insertBefore(a,t.nextSibling):this.containerWithRows.append(a),this.buttonMove&&(a.setAttribute("draggable","false"),a.setAttribute("aria-grabbed","false"),a.setAttribute("tabindex","0")),a.setAttribute("data-new","1"),this.fixUniqueAttributes(a,r),this.dispatchEvent(new CustomEvent("subform-row-add",{detail:{row:a},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(a,"joomla:updated"),a}},{key:"removeRow",value:function(t){this.getRows().length<=this.minimum||(this.dispatchEvent(new CustomEvent("subform-row-remove",{detail:{row:t},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(t,"joomla:removed"),t.parentNode.removeChild(t))}},{key:"fixUniqueAttributes",value:function(t,r){var a=this;this.lastRowNum++,r=r||0;var n=t.getAttribute("data-group"),i=t.getAttribute("data-base-name"),o=Math.max(this.lastRowNum,r+1),u=i+o;this.lastRowNum=o,t.setAttribute("data-group",u);for(var l=t.querySelectorAll("[name]"),s={},b=0,f=(l=[].slice.call(l).filter(function(t){return e(t,"joomla-field-subform")===a})).length;b<f;b++){var m=l[b],d=m.getAttribute("name"),c=d.replace(/(\[\]$)/g,"").replace(/(\]\[)/g,"__").replace(/\[/g,"_").replace(/\]/g,""),g=d.replace("["+n+"][","["+u+"]["),h=c.replace(n,u),p=0,v=c;if("checkbox"===m.type&&d.match(/\[\]$/)){if(!(p=s[c]?s[c].length:0)){var A=e(m,"fieldset.checkboxes"),y=t.querySelector('label[for="'+c+'"]');A&&A.setAttribute("id",h),y&&(y.setAttribute("for",h),y.setAttribute("id",h+"-lbl"))}v+=p,h+=p}else if("radio"===m.type){if(!(p=s[c]?s[c].length:0)){var w=e(m,"fieldset.radio"),E=t.querySelector('label[for="'+c+'"]');w&&w.setAttribute("id",h),E&&(E.setAttribute("for",h),E.setAttribute("id",h+"-lbl"))}v+=p,h+=p}s[c]?s[c].push(!0):s[c]=[!0],m.setAttribute("name",g),m.setAttribute("id",h);var R=t.querySelector('label[for="'+v+'"]');R&&(R.setAttribute("for",h),R.setAttribute("id",h+"-lbl"))}}},{key:"setUpDragSort",value:function(){function t(t){return!t.form&&t[i](that.buttonMove)?t:e(t,that.buttonMove)}function a(t,e){var r=!1;if(t.parentNode===e.parentNode)for(var a=t;a;a=a.previousSibling)if(a===e){r=!0;break}r?e.parentNode.insertBefore(t,e):e.parentNode.insertBefore(t,e.nextSibling)}for(var n,o=this.getRows(),u=0,l=o.length;u<l;u++)(n=o[u]).setAttribute("draggable","false"),n.setAttribute("aria-grabbed","false"),n.setAttribute("tabindex","0");this.addEventListener("touchstart",function(r){touched=!0;var n=t(r.target),i=n?e(n,that.repeatableElement):null;i&&e(i,"joomla-field-subform")===that&&(item?(i!==item&&a(item,i),item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null):(i.setAttribute("draggable","true"),i.setAttribute("aria-grabbed","true"),item=i),r.preventDefault())}),this.addEventListener("mousedown",function(r){if(!touched){var a=t(r.target),n=a?e(a,that.repeatableElement):null;n&&e(n,"joomla-field-subform")===that&&(n.setAttribute("draggable","true"),n.setAttribute("aria-grabbed","true"),item=n)}}),this.addEventListener("mouseup",function(){item&&!touched&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)}),this.addEventListener("keydown",function(t){if((t.keyCode===r.ESC||t.keyCode===r.SPACE||t.keyCode===r.ENTER)&&!t.target.form&&t.target[i](that.repeatableElement)){var n=t.target;if(n&&e(n,"joomla-field-subform")===that&&(t.keyCode===r.SPACE&&((o=t).ctrlKey||o.metaKey||o.shiftKey)&&("true"===n.getAttribute("aria-grabbed")?(n.setAttribute("draggable","false"),n.setAttribute("aria-grabbed","false"),item=null):(item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),n.setAttribute("draggable","true"),n.setAttribute("aria-grabbed","true"),item=n),t.preventDefault()),t.keyCode===r.ESC&&item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),t.keyCode===r.ENTER&&item)){if(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),n===item)return void(item=null);a(item,n),t.preventDefault(),item=null}}var o}),this.addEventListener("dragstart",function(t){item&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",""))}),this.addEventListener("dragover",function(t){item&&t.preventDefault()}),this.addEventListener("dragenter",function(t){if(item&&(!that.rowsContainer||e(t.target,that.rowsContainer)===that.containerWithRows)){var r=t.target[i](that.repeatableElement)?t.target:e(t.target,that.repeatableElement);r&&a(item,r)}}),this.addEventListener("dragend",function(){item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)})}}]),o}();t.define("joomla-field-subform",o)}(customElements)},{}]},{},[1]);